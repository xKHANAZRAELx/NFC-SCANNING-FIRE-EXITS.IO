<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NFC Scan Tracker</title>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>
    <script>
        // Your Firebase configuration
        const firebaseConfig = {
            apiKey: "AIzaSyDj2uosWcsHdGWm31_w_5LJ-i34IGZY_us",
            authDomain: "nfc-scan-tracker.firebaseapp.com",
            databaseURL: "https://nfc-scan-tracker-default-rtdb.firebaseio.com",
            projectId: "nfc-scan-tracker",
            storageBucket: "nfc-scan-tracker.appspot.com",
            messagingSenderId: "565206205474",
            appId: "1:565206205474:web:5959b2c68c0415a082b67b",
            measurementId: "G-TWLF5S7T40"
        };

        // Initialize Firebase
        firebase.initializeApp(firebaseConfig);
        const database = firebase.database();

        async function setupNFC() {
            if ('NDEFReader' in window) {
                const ndef = new NDEFReader();
                await ndef.scan();
                console.log("NFC scanning started...");

                ndef.onreading = event => {
                    const tagData = new TextDecoder().decode(event.message.records[0].data);
                    console.log(`NFC tag data: ${tagData}`);
                    handleNFCData(tagData);
                };

                ndef.onreadingerror = () => {
                    console.error("Error: Cannot read data from the NFC tag.");
                };
            } else {
                console.error("This browser does not support Web NFC.");
            }
        }

        function handleNFCData(nfcData) {
            const ref = database.ref('nfc_scans');
            ref.push({
                nfcData: nfcData,
                timestamp: firebase.database.ServerValue.TIMESTAMP
            });
            updateDisplay(nfcData);
        }

        function updateDisplay(nfcData) {
            document.getElementById('scan-results').textContent = `Scanned NFC Data: ${nfcData}`;
        }

        document.addEventListener('DOMContentLoaded', setupNFC);
    </script>
</head>
<body>
    <h1>NFC Scan Tracker</h1>
    <div id="scan-results">Waiting for scan...</div>
</body>
</html>
